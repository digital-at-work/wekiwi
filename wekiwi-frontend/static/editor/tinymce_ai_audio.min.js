tinymce.PluginManager.add("audioRecorderPlugin",(function(t){let e,o,n,i=[],r=!1;async function a(){o=await navigator.mediaDevices.getUserMedia({audio:!0}),e=new MediaRecorder(o),e.ondataavailable=t=>{i.push(t.data)},e.onstop=async()=>{const e=new Blob(i,{type:"audio/wav"});i=[],await t.getParam("chatPlugin").getResponse(e,t)}}function d(){i=[],e.start(),r=!0,u()}function c(){e.stop(),r=!1,u()}function u(){r?(recordButton.icon("stopRecord"),recordButton.tooltip("Stop Audio Transcription"),n=setInterval((()=>{"1"==recordButton.element().style.opacity?recordButton.element().style.opacity="0.5":recordButton.element().style.opacity="1"}),500)):(recordButton.icon("startRecord"),recordButton.tooltip("Start Audio Transcription"),n&&clearInterval(n),recordButton.element().style.opacity="1")}return t.ui.registry.addIcon("startRecord",'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="red" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mic"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></svg>'),t.ui.registry.addIcon("stopRecord",'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="red" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mic-off"><line x1="2" x2="22" y1="2" y2="22"/><path d="M18.89 13.23A7.12 7.12 0 0 0 19 12v-2"/><path d="M5 10v2a7 7 0 0 0 12 5"/><path d="M15 9.34V5a3 3 0 0 0-5.68-1.33"/><path d="M9 9v3a3 3 0 0 0 5.12 2.12"/><line x1="12" x2="12" y1="19" y2="22"/></svg>'),t.ui.registry.addButton("audioRecorderPlugin",{icon:"audio",tooltip:"Record Audio",onSetup:function(t){return recordButton=t,function(){r&&c(),o&&o.getTracks().forEach((t=>t.stop()))}},onAction:function(){r?c():a().then(d)}}),t.ui.registry.addMenuItem("audioRecorderPlugin",{text:"Record Audio",onAction:function(){r?c():a().then(d)}}),{getMetadata:function(){return{name:"Audio Recorder Plugin"}}}}));